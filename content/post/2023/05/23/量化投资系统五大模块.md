---
layout:      post
title:       "量化投资系统的五大核心模型"
subtitle:    "Five Core Models of Quantitative Investment Systems"
description: "量化投资系统五大核心模型包括超额收益模型、风险管理模型、交易成本模型、投资组合构建模型、执行模型。"
author:      "XiangdiWu"
date:        2023-05-23
image:       "/img/background.webp"

categories:  ["Quant" ]
tags:
    - Quant

URL:         "/2023/05/23/five-core-models-of-quantitative-investment-systems/"
---
> 本文系统介绍了量化投资系统的五大核心模型，旨在通过数据驱动和理论驱动的方法优化投资决策。

量化投资系统包括五大模型：

1、超额收益模型 Alpha Models<br>
2、风险管理模型 Risk Model<br>
3、交易成本模型 Transaction Cost Models<br>
4、投资组合构建模型 Portfolio Construction Models<br>
5、执行模型 Execution Models<br>

# 超额收益模型 Alpha Models

Alpha 模型是用于预测资产或投资组合的 Alpha 值的模型。在金融投资领域，Alpha 通常指的是资产或投资组合相对于市场基准的超额收益。

Alpha 模型旨在通过识别和预测可以产生超额收益的投资机会，帮助投资者或投资机构实现比市场平均表现更好的投资回报。他基于历史数据、统计分析和数学模型来探索和利用市场中的非随机性模式和价格变动。

投资者回报中与市场基准无关的部分称为超额收益，Alpha Models 的本质是通过识别和利用市场中的非随机性模式和价格变动，预测资产或投资组合的超额收益。

如果一个基金经理管理的基金上涨了12%，而他对标的指数基准上涨了10%，一个快速的粗略分析将显示他的 Alpha 收益是+2%。国内市场的指数增强产品所追求的就是基于中证指数的超额收益。

事实上，只有少数的交易策略为寻找 Alpha 收益而存在。但这些基本策略可以通过多种方式来实现，从而能够从有限的核心思想中创造出令人难以置信的策略多样性。理解交易策略的第一个关键是理解量化交易策略对科学的看法。

科学的两个主要分支是理论主义和经验主义。理论科学家试图通过假设为什么它是这样来理解周围世界；实证科学家相信，对世界的足够观察可以让他们预测未来的行为模式。理论科学和经验科学之间的区别与量化策略密切相关，因此也有两种 Alpha Models。

Alpha Models 可以被分为两类：理论驱动与数据驱动。

现有的大部分 Alpha Models 都是基于理论驱动的，基金经理们从一些经济上可行的解释开始，解释为什么市场以某种方式行事，并测试这些理论，看看他们是否可以用来预测未来市场行为，以期获得超额收益。

## 理论驱动的超额收益模型 Theory-Driven Alpha Models

理论驱动的 Alpha Models 可以分为两大类：量价模型与基本面模型，在此基础上又可以细分出六种细分模型：

![img](/img/2023/05/23/95d813d1-c31a-4407-a0e1-28ffb19c08d7.png)

### 趋势跟踪 Trend

趋势跟踪是基于这样一种理论，即市场有时会向一个特定的方向移动足够长的时间，以便人们能够识别并且驾驭这种趋势。这一理论催生出了一种追涨杀跌的现象，因为人们相信趋势，倾向于购买有上涨趋势的东西，卖出有下跌趋势的东西，这种行为本身就使得趋势得以延续下去。获利的关键在于，总要把你的东西卖给愿意用更高价格买入的人。

举例说明：

当我们对股票市场建立Alpha Models时，我们可以考虑回看各只股票的历史数据，如果一支股票在过去某段历史上一直处于上涨趋势，我们可以相信这种趋势将持续到未来的时刻，对这只股票赋予更高的权重。相反如果一支股票处于持续下跌趋势，我们同样可以相信它在未来的时刻依然会有下跌的可能，因此给予较低的权重。

股票的历史平均收益率、收盘开盘价格、交易量、交易金额等数据都可以作为趋势的衡量标准。

### 均值回归 Reversion

当价格波动时，他们要么朝着趋势相同的方向移动，要么朝着趋势相反的方向移动，前者由趋势描述。当价格朝着与普遍趋势相反的方向移动时，这一现象由反转进行描述，即均值回归策略。均值回归策略背后的理论是存在一个围绕价格波动的重心，并且有可能确定这个重心和波动来保证交易的进行。

存在均值回归现象，有几个有效的理由：

首先，仅仅由于流动性需求，导致一种产品被过度买卖，买卖双方之间有时会出现短期失衡，因此价格会突然上涨，一旦来自买家的过剩需求消退，这就增加了价格在某个时刻再次逆转的可能性。

另一个解释均值回归现象的理由是，市场参与者并不完全知晓彼此的观点和行动，因此当他们各自下单推动价格朝向新的均衡水平时，价格可能会因为任意时刻存在的供需过剩而超出正常水平。

回顾先前的两种现象，趋势和均值回归策略并不一定会相互矛盾。在较长期的时间尺度下，趋势现象可以发生，其中存在短期内围绕这些趋势发生较小的均值回归现象，将这两种策略结合使用是较为常见的做法。与趋势跟踪类似，对于均值和反转的定义有很多种方式，可以对收盘、开盘价、交易量等量价信息进行均值反转定义。

### 情绪因子 Technical Sentiment

通过跟踪投资者以及市场的情绪（一般通过价格、成交量和波动性行为表达）以作为未来收益的衡量指标。

与趋势回归的情况不同，没有明确的经济理论支撑这种现象，对于情绪信息在预测中的价值和使用，不同的投资者有不同的看法。

观察市场情绪有多种方式。

首先是观察期权市场，以确定其潜在的市场情绪，观察看跌期权和看涨期权的数量，并以此作为市场情绪的指标。如果看跌期权相对于看涨期权的成交量高于平均水平，这可能是投资者担心经济低迷的一个迹象，如果看跌期权的成交量低于看涨期权，这可能是一个看涨情绪指标。

第二种方式是将交易量、未平仓合约或其他相关类型的输入作为未来价格的预测指标。在最短时间框架内，一些高频交易员会评估限价订单薄的形状以确定短期市场情绪。

对部分投资人而言，某些产品中高度的积极情绪表明，该产品已经超买，因此准备下跌，但对于另一部分投资人来说，高度的积极情绪将表明该产品有上涨的可能。

### 价值策略 Yield

价值策略是一种被广泛使用的策略，在股票与其他产品中应用。资产类别的价值可以被多个指标进行衡量，但大多数指标最终是某些基本因素与资产价格的比率，如市盈率（P/E），市盈率的计算方法是将公司的市值（市场总值）除以公司的净利润（或每股盈利）。

设想一家恰好收益为零的公司或股票，此时市盈率将无法计算，因此使用市盈率的倒数形式 E/P 更为合适，这个指标表达了每投资一单位货币（通常是股票价格），可以获得多少单位货币的收益（每股收益）。

价值策略，它背后蕴藏的核心理念是市场往往高估风险较高的资产，并可能低估风险较低的资产。因此，持有风险较高的资产或卖出风险较低的资产可能会获利。

当在相对基础上进行操作时，既买入被低估的股票，并卖出被高估的股票，这种策略也被称为套利交易。投资者从多头头寸获得较高收益率，并以空头头寸进行融资。所获得的收益率与支付的收益率之间的差额就是套利收益。例如，可以做空1,000,000美元的美国债券，并用所得资金购买1,000,000美元收益较高的墨西哥债券。

### 增长策略 Growth

增长策略旨在基于所涉及资产预期或历史观察到的经济增长水平进行预测。这里的理论依据是，在其他条件相等的情况下，购买正在经历快速经济增长的资产或卖出正在经历缓慢或负增长的资产是更好的选择。一些增长指标，例如适盈率与盈利增长率之比（PEG），基本上是一个前瞻性的价值概念；也就是说，他们将增长预期与价值预期进行比较，以确定给定资产是否合理的定价了交易员认为该资产可能经历的正增长或负增长。

如果你预计一项资产会迅速增长，但市场已经考虑了这种增长并进行了定价，那么对于投资者来说，就没有交易空间了。事实上，如果市场所反映的增长比你预期的要多得多，那么做空该资产反而是更合理的。

### 资产质量 Quality

基于理论驱动的 Alpha Models 的最后一种类型是质量。投资者相信，在其他条件相同的情况下，拥有高质量的资产，而卖出或做空低质量的资产是更好的策略。这一策略出现的原因是，资产的安全性很重要，而增长和价值策略都没有真正兼顾这一概念。专注于拥有更高质量资产的策略，可能有助于保护投资者，特别是在压力巨大的市场环境下。

质量信号可以分为五类：

首先是杠杆，基于杠杆指标的衡量，投资者应该做空杠杆较高的公司，做多杠杆较低的公司。

第二种质量信号是收入来源的多样性，那些收入来源更多样化的公司比那些收入来源较少的公司质量更高。因此，在其他条件相同的情况下，服务各行各业客户，收入来源多样的公司应该比为某种狭窄目的提供单一服务的公司更稳定。

第三种质量信号是管理质量，由好团队领导的公司质量更加优秀。

第四种质量信号是欺诈风险，买入欺诈风险较低的资产，出售欺诈风险较大的资产。

最后一种信号与投资者对资产发行者质量的信心有关。换句话说，人们对杠杆率、收入多样性、管理质量或欺诈风险的变化潜在的看法。然而，这种信号并不是特别常见，而且由于关于质量的情绪来源相对较少，也很难进行回测和获得任何形式的统计意义，在实际应用中很少使用。

质量的表现随着时间的推移而波动很大，并且高度依赖于市场环境，寻找到高质量的信号，可以帮助投资者很好的获利或者规避风险。

2008年市场出现的一些质量型号有助于交易员发现、避免买入或卖些杠杆率最大的银行，从而2008年的次贷危机，甚至从中获利。

但当市场整体表现良好时，质量信号的表现往往不佳，在市场进入乐观状态时，质量信号的表现会十分糟糕。

## 数据驱动的超额收益模型

数据驱动的 Alpha Models 的实际应用范围比理论驱动小得多，因为数据驱动的模型更加复杂，可解释性较差。当其用作 Alpha 模型时，输入通常来自交易所给出的量价数据，数据驱动的策略试图从中寻求、识别对未来有一定解释力的模式。

举例：许多高频交易员在设计股票、期货和外汇市场的短期交易策略时，倾向于完全的数据驱动策略。这些策略可能在高频率上更成功，因为如果设计好，他们能够辨别市场的行为，而不必担心这种行为背后的经济理论是否合理。

### 数据驱动的超额收益模型的优点

首先，与理论驱动的策略相比，数据驱动策略在技术上更具挑战性，实践应用也要少得多。这意味着竞争对手的数量较少，策略不会拥挤。

其次，数据驱动策略可以识别数据的模式，而不需要去理解这种模式出现的原因，相比之下，理论驱动的策略捕获了投资者已经识别和命名的行为类型，这可能将策略限制在本届前面描述的六个类别中。

### 数据驱动的超额收益模型的缺点

首先，研究员必须选择提供给模型的数据，确保这些数据是和预测目标息息相关，并能够提供充分的信息。

其次，在海量的被认为有效的数据中，算法需要的搜索量是巨大的，以至于完全不切合实际。

另外，金融市场数据信噪比较低，模型输入含有大量的错误信息，对于模型而言意味着学习上的陷阱。

# 风险管理模型 Risk Model

假定我们作为投资经理设计了一种 Alpha 策略，该策略关注各种股票的价值（收益率），购买高收益股票并卖出低收益股票。但如果高收益股票的表现不如低收益的股票，这种策略显然可能亏损。即使投资经理有理由相信长期来看价值策略应该能赚钱，但这种策略本身却包含固有的风险。

如果投资经理不对这种风险采取措施，策略可能还会在投注价值的同时承担重大的行业博弈。毕竟，同一行业的股票倾向于一起波动。

因此，如果一只科技股变得非常廉价，其他许多科技股也有很大可能变得廉价。

这意味着策略很可能会在科技股领域形成净多头头寸。但没有证据表明在一个行业或部门相对于另一个行业或部门进行过度配重会带来长期利益。

更重要的是，该策略既没有意图也没有能力预测各个行业的表现。因此，在上述案例中，行业敞口将被视为一种风险形式，因为策略并非有意地预测行业表现，但该风险可能会改变策略的日常结果。

因此，理解与量化交易策略相关的风险敞口的关键在于，风险敞口是那些在 Alpha 模型中投资经理所做的任何预测性质之外，不是有意追求的敞口。

如果 Alpha Models 像是乐观主义者，那么 Risk Models 就像是悲观主义者。Risk Models 的存在主要是为了控制敞口规模，或者应对不希望出现的敞口。它们的任务是对可能导致损失或不确定性的事物发出警示，特别是那些无意中出现的敞口或是 Alpha Models 的附带产物，限制或消除投资组合中的不良敞口。

Risk Models 的功能分为两类：规模限制 Limiting the Amount of Risk 和 Limiting the Types of Risk

## 规模限制 Limiting the Amount of Risk

规模限制是 Risk Models 的一种重要形式，专注于限制规模的 Risk Models 较为常见，具体可以分解为三个部分：Limiting by Constraint or Penalty、Measuring the Amount of Risk、Where Limits Can Be Applied。

### 硬性限制和惩罚 Limiting by Constraint or Penalty

在规模限制方面，有两种主要的方法：硬性限制和惩罚。硬性限制是为了在风险方面设立界限。例如，有一个头寸限制规定，无论信号有多强，任何头寸都不得超过投资组合的3%。然而，这种硬性限制可能有些随意。因此投资经理有时会构建惩罚函数，允许头寸超过限制水平，但前提是 Alpha 模型预计有更高的回报。惩罚函数的工作原理是随着超过硬性限制水平的增加，增加头寸规模变得越来越困难。

限制和惩罚的水平通过理论驱动方法或数据驱动方法确定。理论驱动的方法通常看起来像是设定一个随意的水平，进行测试，并在需要时进行调整，直到产生可接受的结果为止。

数据驱动的方法更加多样，可以包括使用机器学习技术来测试许多限制的组合，或者仅仅测试不同的限制水平，并让历史数据经验性地确定最终结果。

无论哪种方式，限制水平和惩罚函数的严重程度都是 Risk Models 的参数，投资经理必须根据研究或启发式方法来设置。

有两种方法来衡量市场中的风险程度。第一种是纵向方法，通过计算一段时间内各种资产的回报的标准差来衡量风险，这是一种了解不确定性的方式。在金融界，通常将这个概念称为波动性。波动性越大，市场中的风险就越高。

### 测量风险 Measuring the Amount of Risk

第二种衡量风险的方法是测量给定投资范围内各种资产行为的相似性水平。这通常通过计算给定期间内所有资产的横截面标准差来完成。标准差越大，底层资产的行为越多样化。这意味着市场风险较低，因为投资组合可以由更多样化的组合组成。

### 限制适用领域 Where Limits Can Be Applied

限制规模的模型可以用来管理各种风险敞口。可以限制单个头寸或一组头寸的规模。另外，还可以限制对各类风险的敞口规模。

在股票交易中，可以限制模型对市场赌注的敞口(如 +/-5% 的净敞口限制)通常，被限制或受到处罚的风险是那些 Alpha 模型没有明确预测到的风险。如果一个 Alpha 模型尝试预测个别股票但不试图预测整个股市，限制投资组合对股市的风险敞口规模可能是明智之举。

## 类别限制 Limiting the Types of Risk

限制风险敞口规模很重要，但一些风险建模方法专注于完全消除某些类型的敞口。消除某些类型敞口的量化风险模型有两种常见的方法：理论模型和经验模型。

基于理论的风险模型通常侧重于系统性的风险因素。就像基于理论的 Alpha 模型一样，从理论中派生出的系统性风险是投资经理可以进行合理经济论证的风险因素。基于理论的风险建模使用一组预定义的系统性风险，使投资经理能够测量和校准给定投资组合的敞口。

回顾之前的例子，如果投资经理正在构建一个 Alpha 策略来预测股票收益率，他可能认为自己没有有效的方法来预测这些股票所属行业的收益率。在这种情况下，投资经理可以设计风险模型，使他对股票的回报率相对于其所属行业的回报率进行预测，这意味着他从未对行业本身的走向进行预测，只对哪些股票会表现优于行业，哪些股票会表现不及行业进行预测。

## 理论驱动的风险管理模型 Theory-Driven Risk Models

需要注意的是，系统性风险是无法通过分散投资消除的风险。在个别股票中，市场本身就是一种系统性风险，因为无论如何在各种个别股票之间进行分散投资，投资者都无法消除对市场表现本身的敞口。

如果市场上涨很多，持有股票的投资组合很可能也会上涨。如果市场大幅下跌，持有股票的投资组合很可能会下跌。行业风险和市值风险(即小市值股与大市值股之间的风险)也是系统性风险的例子。

同样，固定收益领域存在许多系统性风险。无论是持有企业债券还是政府债券，这些债券的持有人都面

临利率风险，即利率上升的风险。

类似的例子可以在任何资产类别中找到，通常也跨越不同的资产类别。换句话说，任何经济上有效的资产组合都可以说共享一个或多个共同的系统性风险因素。因此，交易任何这些资产的投资者应意识到这个风险因素，并且应该有意地消除他们的敞口。

## 经验驱动的风险管理模型 Empirical Risk Models

经验风险模型与基于理论的模型具有相同的前提，即系统性风险应该被测量和减轻。然而，经验方法使用历史数据来确定这些风险以及给定投资组合对这些风险的敞口程度。通过使用主成分分析(PCA)等统计技术，投资经理能够利用历史数据来识别那些没有名称但可能与已命名的风险因素相对应的系统性风险。

对债券市场数据(如各种到期日的国债)进行PCA分析通常会显示第一个(最重要)统计风险因素与利率水平对应，或者可以称之为利率风险的理论驱动风险模型。PCA和其他统计模型在股票市场中也被广泛使用，这些模型通常发现市场本身是给定股票收益的第一个、最重要的驱动因素，通常其后是所属行业。

这种方法可能会发现全新的系统性风险因素，投资经理们可能会承认它们的存在，但尚未分配名称。另一方面，统计风险模型容易被数据误导，找到的风险因素在未来的有效时间内可能不会持续存在。统计风险模型也有可能发现虚假的敞口，这些只是巧合，并不代表市场中存在任何真正的风险。这对研究者来说是一个微妙的问题。

# 交易成本模型 Transaction Cost Models

到目前为止，我们已经讨论了Alpha模型和风险模型，它们都是黑盒模型的关键要素。Alpha模型扮演着一个梦想家的角色，而风险模型则扮演着一个紧张的担忧者的角色。在这个比喻中，交易成本模型将是一个节俭的会计师。

交易成本模型的理念是，进行交易是需要成本的，因此除非有非常充分的理由，否则不应该进行交易。即使是理论上可以获利的策略，其中的交易成本也会吞噬掉他们20%到50%的收益。

在量化交易的世界中，只有两个原因可以进行交易：

第一，如果交易可以提高赚钱的几率或幅度(根据Alpha模型的指示)

第二，如果交易可以降低亏损的几率或幅度(根据风险模型的指示)

交易成本模型是一种定量衡量特定规模交易的成本的方式，以便将此信息与Alpha模型和风险模型结合使用，确定最佳的投资组合。

值得注意的是：交易成本模型的设计目标并不是为了最小化交易成本，而是为了向投资组合构建引擎提供交易的成本信息。如果交易者低估了交易成本，系统可能会进行过多的交易，这些交易的效益不足，从而导致不断接受交易成本而造成损失。如果交易者高估了交易成本，这可能导致交易过少，通常会导致持仓时间过长。无论哪种情况，交易者最终都会获得次优的绩效，这凸显了正确估计交易成本的重要性。

交易成本主要有以下三个部分组成：佣金和费率 Commissions and Fees、滑点 Slippage、市场冲击 Market Impact。

## 佣金和费率 Commissions and Fees

佣金和费用是交易成本的第一种形式，支付给券商、交易所和监管机构，用于他们提供的服务，包括与其他市场参与者的接触、交易安全性的提高和运营基础设施。

这些是交易模型成本中固定的一部分，容易建模计算。

## 滑点 Slippage

佣金和费用确实不可忽视。但对于大多投资经理来说，它们也不是交易成本的主要组成部分。而且它们基本上是固定的，这使得它们易于建模。相反，滑点和市场影响要建模和管理起来就复杂得多。

滑点是指交易者(或量化系统)决定进行交易和订单实际到达交易所执行之间的价格变动。市场价格不断变动，但交易决策是基于特定时间点进行的。随着时间的推移，决策和实际交易执行之间的时间差，被预测的资产的价格很可能偏离预测时的报价。

策略中最容易受到滑点影响的是趋势跟随策略，因为它们试图买入和卖出已经朝着预期方向移动的资产。而最不容易受到滑点影响，并且有时滑点甚至可能是正向的策略是均值回归策略，因为这些策略通常试图在下单时买入和卖出朝着相反方向移动的工具。

交易系统的延迟或市场反应速度对其策略随时间经历的滑点水平有很大影响。这是因为滑点是在订单决策和订单到达市场执行之间经过的时间的函数。交易系统与市场的通信延迟越大，订单到达市场前经过的时间越长，工具的价格离决策时的价格就可能越远。更糟糕的是，在短期交易内，预测越准确，滑点对策略的影响越大。

除了时间外，滑点还与所预测的资产的波动性有关。如果我们正在预测一年期的国债券，它们在一天内的波动通常小，并且在某些时间几乎没有太多波动，那么滑点可能不是一个主要因素。另一方面，如果我们正在预测一个波动性很高的互联网股票，滑点可能是一个重大问题。

## 市场冲击 Market Impact

市场冲击是交易成本的最后一个主要组成部分，指的是当交易员买入一种资产时，该资产的价格往往会上涨，部分可能是由于交易员的订单所引起的。相反，当交易员卖出资产时，价格会下降。对于小额订单，价格波动通常在当前的最佳买价和卖价之间徘徊。

然而，对于较大的订单，价格波动可能会很大，范围可达几个百分点，甚至更高。通常，市场冲击被定义为市价订单进入交易所时的价格与实际执行交易时的价格之间的差异。

市场冲击的基本概念基于供求的普遍原理，当交易员准备执行某一规模的交易时，必须有人愿意与其对立交易或提供所需规模的流动性。交易者需求规模越大，交易成本就越高，因为需要获取更多的供应。

此外，许多其他因素可能影响市场冲击的观察结果，并使其量化变得复杂，在交易成本建模中，通常不考虑这些因素，而是着重于订单规模与当时可用流动性之间的关系。流动性可以通过买价或卖价上可用的资产规模，或者通过订单簿的深度来衡量，后者指的是远离最佳买卖价的买单或卖单。

# 投资组合构建模型 Portfolio Construction Models

投资组合构建模型的目标是确定投资经理想要拥有的投资组合。该模型扮演着仲裁者的角色，听取乐观主义者(Alpha模型)、悲观主义者(风险模型)和注重成本的会计师(交易成本模型)的论点，然后做出决策。在投资组合中对各种持仓进行分配的决策主要基于对预期收益、风险和交易成本的综合考量。

过于强调机会可能会因忽视风险而导致灾难。过于强调风险可能会因忽视机会而导致业绩不佳。过于关注交易成本可能会导致犹豫不决，因为这往往会使交易员无限期地持有头寸，而不愿意承担更新投资组合的成本。

量化投资组合构建模型分为两种主要形式。

第一类是基于规则的模型。基于规则的投资组合构建模型基于量化交易者定义的启发式规则，可以非常简单或相当复杂。通常使用的启发式规则是从人类经验中得出的规则，比如通过试错方法获得的规则。

第二类量化投资组合构建模型是优化模型。优化模型利用算法，即一系列逐步规定的规则，旨在帮助用户从起始点到达目标点，以寻求达到量化交易者定义的目标的最佳方式。

## 基于规则的模型 Rule-Based Portfolio Construction Models

有四种常见的基于规则的投资组合构建模型：等权重持仓、等风险权重持仓、基于 Alpha 的权重持仓、决策树权重持仓。

### 等权重持仓 Equal Position Weighting

等权重持仓模型非常常见。这些模型认为，如果一个头寸看起来足等权重模型的基本前提是，试图区分一个头寸与另一个头寸的规模够好，就不需要其他信息来确定其规模。进一步隐含的假设是，这些有两个潜在的不利后果，这些不利后果最终超过了不均等加权带来的投资工具在风险或其他方面足够均质，不需要根据它们的风险性质进潜在好处。换句话说，投资经理选择等权重模型是因为他们认为不均等加权存在许多劣势。

不均等加权的第一个潜在问题是它隐含地假设有足够的统计力量和能力来预测一个头寸在未来的涨跌方向，以及相对于投资组合中其他预测的幅度和概率。

不均等加权投资组合的第二个潜在问题是，它通常会导致愿意在 “最佳”预测上进行大赌注，而在较不明显的预测上进行许多较小的赌注。然而，这种权重不平衡可能导致策略在看似有吸引力的头寸上承担过多的特定事件风险。

因此，均等加权方法的基本论点是通过将赌注分散在最大数量的头寸上来减轻风险。

### 等风险权重持仓 Equal Risk Weighting

等风险权重持仓是指头寸大小与其波动性(或其他风险度量，如回撤大小等)成反比进行调整。波动性较大的头寸获得较小的分配，而波动性较小的头寸获得较大的分配。通过这种方式，每个头寸通过分配对投资组合所贡献的风险量来实现平等化。

其理论基础很简单。一只具有较大波动的小市值股票不应该获得与具有较小波动的大市值股票完全相同的分配。因此，一些认为等权重持仓是最合适的方法的投资经理会采用等风险权重持仓，以改善实际获得的真正分散效果。

### 基于 Alpha 的权重持仓 Alpha-Driven Weighting

第三种方法是根据 Alpha 模型确定头寸大小。这种方法的理念是 Alpha 模型决定了一个头寸的吸引力程度，并且这个信号是正确确定头寸大小的最佳方式。然而，大多数采用这种方法的投资经理并不会允许最大头寸大小没有限制。因此，他们会使用风险模型来为单个头寸设置最大限制。

根据这个限制，信号的强度决定了头寸实际上能够到达的最大限制程度。这就像按曲线分级一样，最高分数对应最大的头寸大小，而低于最高分数的分数对应较小的头寸大小。在这种投资组合构建方法中使用的约束类型还可以包括对某个组合(例如，行业或资产类别)的总投资金额设定限制。例如，可以将单个头寸限制为不超过投资组合的3%,并且将每个行业投资金额限制为不超过20%。

通常情况下，预测 Alpha 值越大，头寸越大。一些量化交易员更喜欢 Alpha 加权的方法。然而，一些采用这种方法的量化策略可能会经常遭受剧烈回撤。这是因为这些模型通常在价格趋势已经确立时产生最大的信号。随着趋势的进行，头寸的规模会增长，但这往往会导致交易员在趋势逆转时持有最大的头寸。因此，在使用基于 Alpha 的投资组合构建算法时需要谨慎，因为这种方法严重依赖于 Alpha 模型的正确性，不仅要求其对一个资产的涨跌方向的预测准确，还要求对其涨跌幅度的预测准确。

## 总结规则模型 Summary of Rule-Based Models

无论使用哪种类型的基于规则的投资组合构建模型，Alpha模型、风险模型和交易成本模型都可以纳入投资组合构建中。例如，在等权模型中，对等权分配的约束是不可缺少的，因为根据交易成本模型，某些资产的交易成本太高。这些因素可以在Alpha模型本身内进行考虑，例如通过添加一个调节变量，如果预期回报低于预期交易成本阈值，则将预期回报(或评分或其他形式的预测)设置为“0”。

基于规则的投资组合构建模型可以非常简单(如等权投资组合的情况)或相当复杂(如具有多种约束条件的Alpha加权情况)。所有这些模型的共同难点是制定驱动它们的规则要合理且理性。

## 投资组合优化器 Portfolio Optimizers Construction Models

投资组合优化器基于现代投资组合理论(MPT)的原则，其核心原则是投资者本质上是风险厌恶的，优化器有三个主要输入：

均值：评估的每个资产的平均预期回报。

方差：各种资产收益的标准差。

相关矩阵：资产的预期相关矩阵。

利用这些输入，优化器提供了一组最高可能回报的投资组合，被称为有效边界。

优化器通过算法进行有向搜索，在边界内搜索其可用的各种资产组合之间的可能性。通过这种方法，优化器能够快速找到一系列最优投资组合，这些投资组合的回报在给定风险水平下无法被其他任何投资组合的回报超过。

下图展示了两种资产的分配比例如何影响组合的夏普率。可以看出在100%多头ABC和100%空头DEF的组合中模型获得了最大的收益。

![img](/img/2023/05/23/image.png)

量化投资发展至今已有有多种优化器可供选择，下面将介绍最为常见的两类：Unconstrained Optimization、Constrained Optimization。

### 无约束优化器 Unconstrained Optimization

无约束优化器的最基本形式是没有任何限制的优化器。如之前的示例，它会建议将投资组合的100%放入单个资产中。事实上，无约束优化器的一个奇怪之处在于，它们经常会提出建议使用单一资产的投资组合，其中所有资金都将投资于风险调整回报最高的资产。

无约束优化器的这种行为是由于其最大化指定度量(例如风险调整回报或夏普比率)的目标，而不考虑投资组合多样化或风险管理的任何限制。虽然这可能导致持仓集中和潜在的更高回报的投资组合，但也使投资组合面临更高水平的风险。

### 有约束优化器 Constrained Optimization

为了解决这个问题，量化分析师们找到了如何在优化过程中添加约束和惩罚，以强制得出更加“合理”的解决方案。有约束的优化器因此诞生，约束可以包括头寸限制(例如，不超过投资组合的3%可以分配给某个头寸)或对各种资产组合的限制(例如，不超过投资组合的20%可以投资于任何一个行业)。

另一类优化约束涉及风险模型的整合。在这方面，有几种实施约束的方法，包括惩罚和硬限制。

如果我们只是想消除行业风险，一个简单的方法可能是修改相关矩阵，使得给定行业内的所有股票之间具有高正相关性，优化器在此修改后的相关结构下解决最佳解。

假设我们施加了市场暴露度约束，使得对ABC和DEF的投注之间的最大差异为20%。在这种情况下，大部分曲面将被优化器忽略，只有满足最大暴露度约束的曲面部分被搜索。

![img](/img/2023/05/23/image2.png)

## 量化投资组合构建模型的输出 Output of Portfolio Construction Models

无论使用何种投资组合构建方法，量化投资组合构建模型的输出是一个目标投资组合：包括每个个别头寸的理想头寸和目标规模。将目标投资组合与当前投资组合进行比较，差异即为需要进行的交易。

如果是从头开始构建一个全新的投资组合，那么投资组合构建模型推荐的所有头寸都需要执行。

如果量化交易员是在正常业务过程中定期重新运行投资组合构建模型，那么只需要进行增量交易，以弥补新推荐的投资组合与他当前持有的现有投资组合之间的差距。

# 执行模型 Execution Models

在我们对量化模型的探索中，我们已经看到了量化交易员如何确定他们想要拥有的投资组合。他们构建了 Alpha 模型、风险模型和交易成本模型。这些模型被输入到投资组合构建模型中，以确定目标投资组合。但是，在纸上或计算机屏幕上拥有目标投资组合与实际拥有该投资组合是有很大区别的。量化模型的最后部分是执行投资组合构建模型做出的投资组合决策，即通过执行所需的交易来实现。

## 订单执行算法 Order Execution Algorithms

订单执行算法在系统化执行投资组合方面起着至关重要的作用，其主要目标是尽可能完整地完成所需的交易，并以最低成本完成。完整性的保证确保了投资组合建模选择的交易得以实施，从而使投资组合与策略保持一致。

订单执行算法有两种一般方法：积极成交和被动成交。

积极成交：它们可以在市场上以任何价格的部分或全部成交(在合理范围内，并且只要订单簿中有一个买盘或卖盘来接受市价单的对手方)。

被动成交：允许交易员控制他愿意成交的最差价格，但交易员必须接受他的订单可能根本不会执行或只执行部分的情况。

给定某个证券的所有可用买盘和卖盘(都是被动订单)的集合被称为限价订单簿(Limit Order Book),可以将其视为一系列限价买单和卖单的队列。

在电子市场中，每个在交易所上提交的订单都会被优先处理。最高优先级给予最好价格的订单(对于买单来说是最好买价，对于卖单来说是最好卖价),而较低优先级则给予那些出价或要价较差的订单。对于出价相同的两个交易者，显示订单的交易者比隐藏订单的交易者具有更高的优先级，如果交易者的优先级仍然相同，决定胜负的标准通常是哪个订单先到达(大多数情况下)。

执行算法必须首先决定采取积极还是被动交易。二者代表交易者希望立即进行交易的程度。市价订单被认为是积极交易，因为交易者向市场表明他只希望立即成交，无论市场目前的价格是多少。限价订单则被认为是被动交易。

通常来说，基于趋势概念的Alpha策略将与更积极的执行策略配对，因为如果交易者不够积极，市场可能会离他而去。通常情况下，均值回归策略会采用更被动的执行策略，因为它们承担着市场趋势持续存在的风险。

影响使用积极或被动执行策略的另一个因素是信号的强度以及模型对该信号的置信度。对于一个更强、更确定的信号，执行策略通常会更加积极，而对于一个较弱或不太确定的信号，执行策略可能更加被动。

假设你得到了内部消息，某支股票会在未来几天内翻倍，而且交易内幕消息是合法可靠的，那么你应该愿意向市场支付大量资金以完成买入该股票的大笔订单，而不是去纠结细微的股票价差。

订单执行算法的第一个特征是它的积极程度，这可以被视为一个光谱。在最积极的一端是市价订单，而在最被动的一端是远离当前市场的限价订单。决定积极的级别通常取决于所采用的策略类型，并且取决于信号的强度、系统对该信号的置信度，有时还包括订单簿的考虑，如微观价格。

## Large Order versus Small Order

无论是市价订单还是限价订单，量化交易者都必须确定一次发送多少总订单量。回顾我们对交易成本模型的讨论，大额订单的执行成本比小额订单要高得多，因此，交易算法执行的常见技术包括将一个大的交易(比如100,000股的股票)分割为100股一单的1,000个订单，并在一段时间内分散执行这些订单。当然，通过分散订单执行时间，交易者面临的风险是价格可能在订单分散执行期间变动得更多。一般而言，分散交易被认为是降低交易成本的有效方法，这也是执行算法中非常常见的特点。发送到市场执行的每个订单的确切大小取决于交易成本模型对所涉及资产的不同大小订单的交易成本估计。

# 完整投资流程图

![投资流程图](/img/2023/05/23/liuchengtu.png)
